"use strict";(self.webpackChunkprivy_atuh=self.webpackChunkprivy_atuh||[]).push([[6360],{86360(e,l,t){t.r(l),t.d(l,{MfaVerifyFlowScreen:()=>u,default:()=>u});var o=t(85089),i=t(58661),n=t(52034),r=t(97916),s=t(67793);t(72025),t(99130),t(15546),t(15656),t(56348);const u=e=>{var l,t,u;let{onClose:a}=e,{user:c}=(0,n.u)(),[d,v]=(0,i.useState)(null!==(l=null===c||void 0===c?void 0:c.mfaMethods[0])&&void 0!==l?l:null),{init:f,cancel:h,submit:k}=(0,r.u)(),[y,w]=(0,i.useState)(!1),[m,S]=(0,i.useState)(null),[p,b]=(0,i.useState)();(0,i.useEffect)(()=>{var e;v(null!==(e=null===c||void 0===c?void 0:c.mfaMethods[0])&&void 0!==e?e:null)},[null===c||void 0===c?void 0:c.mfaMethods]);let g=(0,i.useRef)(!1);async function C(e){b(void 0);try{if(!e||!d)return;await k(d,e),w(!0),b(void 0),a()}catch(e){throw(0,s.t)(e).error}}async function M(e){if("passkey"!==e)try{v(e),await f(e)}catch(e){console.error(e)}else try{v(e);let l=await f(e);if(!l)throw Error("something went wrong");S(l),await k(e,l),w(!0),b(void 0),a()}catch(e){b((0,s.t)(e))}}(0,i.useEffect)(()=>{!g.current&&d&&(g.current=!0,M(d).finally(()=>{g.current=!1}))},[]);let B=()=>{v(null),b(void 0),h(),a()};return c?"passkey"===d?(0,o.jsx)(s.V,{account:c.linkedAccounts.filter(e=>"passkey"===e.type&&e.enrolledInMfa).sort((e,l)=>l.firstVerifiedAt.valueOf()-e.firstVerifiedAt.valueOf())[0],submitSuccess:y,hasBlockingError:null!==(t=null===p||void 0===p?void 0:p.isBlocking)&&void 0!==t&&t,error:null===p||void 0===p?void 0:p.error,onClose:B,onBack:()=>{v(null),b(void 0)},handleSubmit:()=>C(m).catch(b)}):d?(0,o.jsx)(s.a,{submitSuccess:y,hasBlockingError:null!==(u=null===p||void 0===p?void 0:p.isBlocking)&&void 0!==u&&u,handleSubmitCode:C,selectedMethod:d,onClose:B,onBack:c.mfaMethods.length>1?()=>v(null):void 0}):(0,o.jsx)(s.b,{user:c,onSelect:M,handleClose:B}):null}}}]);