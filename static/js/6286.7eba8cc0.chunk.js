"use strict";(self.webpackChunkprivy_atuh=self.webpackChunkprivy_atuh||[]).push([[6286],{12191(t,e,a){a.d(e,{h:()=>d});var n=a(34264),o=a(27626),s=a(27314),i=a(81385),r=a(62091),c=a(45916);async function d(t,e){var a,d,u;const{account:l=t.account,chainId:h,nonce:p}=e;if(!l)throw new o.T({docsPath:"/docs/eip7702/prepareAuthorization"});const v=(0,n.J)(l),m=(()=>{if(e.executor)return"self"===e.executor?e.executor:(0,n.J)(e.executor)})(),w={address:null!==(a=e.contractAddress)&&void 0!==a?a:e.address,chainId:h,nonce:p};return"undefined"===typeof w.chainId&&(w.chainId=null!==(d=null===(u=t.chain)||void 0===u?void 0:u.id)&&void 0!==d?d:await(0,i.T)(t,r.T,"getChainId")({})),"undefined"===typeof w.nonce&&(w.nonce=await(0,i.T)(t,c.y,"getTransactionCount")({address:v.address,blockTag:"pending"}),("self"===m||null!==m&&void 0!==m&&m.address&&(0,s.h)(m.address,v.address))&&(w.nonce+=1)),w}},27626(t,e,a){a.d(e,{T:()=>o,Z:()=>s});var n=a(63536);class o extends n.C{constructor(){let{docsPath:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(["Could not find an Account to execute with this Action.","Please provide an Account with the `account` argument on the Action, or by supplying an `account` to the Client."].join("\n"),{docsPath:t,docsSlug:"account",name:"AccountNotFoundError"})}}class s extends n.C{constructor(t){let{docsPath:e,metaMessages:a,type:n}=t;super('Account type "'.concat(n,'" is not supported.'),{docsPath:e,metaMessages:a,name:"AccountTypeNotSupportedError"})}}},29596(t,e,a){a.d(e,{BH:()=>v,vB:()=>p,yM:()=>m});var n=a(24107),o=a(34264),s=a(63536),i=a(85294),r=a(12844),c=a(350),d=a(89488),u=a(63379),l=a(43877),h=a(96945);const p="0x5792579257925792579257925792579257925792579257925792579257925792",v=(0,u.cK)(0,{size:32});async function m(t,e){const{account:a=t.account,capabilities:m,chain:w=t.chain,experimental_fallback:f,experimental_fallbackDelay:y=32,forceAtomic:g=!1,id:C,version:b="2.0.0"}=e,P=a?(0,o.J)(a):null,T=e.calls.map(t=>{const e=t,a=e.abi?(0,r.p)({abi:e.abi,functionName:e.functionName,args:e.args}):e.data;return{data:e.dataSuffix&&a?(0,c.xW)([a,e.dataSuffix]):a,to:e.to,value:e.value?(0,u.cK)(e.value):void 0}});try{const e=await t.request({method:"wallet_sendCalls",params:[{atomicRequired:g,calls:T,capabilities:m,chainId:(0,u.cK)(w.id),from:null===P||void 0===P?void 0:P.address,id:C,version:b}]},{retryCount:0});return"string"===typeof e?{id:e}:e}catch(x){const a=x;if(f&&("MethodNotFoundRpcError"===a.name||"MethodNotSupportedRpcError"===a.name||"UnknownRpcError"===a.name||a.details.toLowerCase().includes("does not exist / is not available")||a.details.toLowerCase().includes("missing or invalid. request()")||a.details.toLowerCase().includes("did not match any variant of untagged enum")||a.details.toLowerCase().includes("account upgraded to unsupported contract")||a.details.toLowerCase().includes("eip-7702 not supported")||a.details.toLowerCase().includes("unsupported wc_ method")||a.details.toLowerCase().includes("feature toggled misconfigured")||a.details.toLowerCase().includes("jsonrpcengine: response has no error or result for request"))){if(m){if(Object.values(m).some(t=>!t.optional)){const t="non-optional `capabilities` are not supported on fallback to `eth_sendTransaction`.";throw new i.L5(new s.C(t,{details:t}))}}if(g&&T.length>1){const t="`forceAtomic` is not supported on fallback to `eth_sendTransaction`.";throw new i.jz(new s.C(t,{details:t}))}const e=[];for(const o of T){const a=(0,h.v)(t,{account:P,chain:w,data:o.data,to:o.to,value:o.value?(0,d.uU)(o.value):void 0});e.push(a),y>0&&await new Promise(t=>setTimeout(t,y))}const a=await Promise.allSettled(e);if(a.every(t=>"rejected"===t.status))throw a[0].reason;const n=a.map(t=>"fulfilled"===t.status?t.value:v);return{id:(0,c.xW)([...n,(0,u.cK)(w.id,{size:32}),p])}}throw(0,l.p)(x,(0,n.A)((0,n.A)({},e),{},{account:P,chain:e.chain}))}}},52345(t,e,a){a.d(e,{v:()=>o});var n=a(53784);function o(t){let{chain:e,currentChainId:a}=t;if(!e)throw new n.jF;if(a!==e.id)throw new n.EH({chain:e,currentChainId:a})}},87192(t,e,a){a.d(e,{k:()=>l});var n=a(24107),o=a(15882),s=a(2730),i=a(16714),r=a(89488),c=a(65435),d=a(29596);const u=["atomic","chainId","receipts","version"];async function l(t,e){var a;const l=await async function(e){if(e.endsWith(d.vB.slice(2))){const a=(0,i.B)((0,s.iN)(e,-64,-32)),n=(0,s.iN)(e,0,-64).slice(2).match(/.{1,64}/g),o=await Promise.all(n.map(e=>d.BH.slice(2)!==e?t.request({method:"eth_getTransactionReceipt",params:["0x".concat(e)]},{dedupe:!0}):void 0)),c=o.some(t=>null===t)?100:o.every(t=>"0x1"===(null===t||void 0===t?void 0:t.status))?200:o.every(t=>"0x0"===(null===t||void 0===t?void 0:t.status))?500:600;return{atomic:!1,chainId:(0,r.ME)(a),receipts:o.filter(Boolean),status:c,version:"2.0.0"}}return t.request({method:"wallet_getCallsStatus",params:[e]})}(e.id),{atomic:h=!1,chainId:p,receipts:v,version:m="2.0.0"}=l,w=(0,o.A)(l,u),[f,y]=(()=>{const t=w.status;return t>=100&&t<200?["pending",t]:t>=200&&t<300?["success",t]:t>=300&&t<700?["failure",t]:"CONFIRMED"===t?["success",200]:"PENDING"===t?["pending",100]:[void 0,t]})();return(0,n.A)((0,n.A)({},w),{},{atomic:h,chainId:p?(0,r.ME)(p):void 0,receipts:null!==(a=null===v||void 0===v?void 0:v.map(t=>(0,n.A)((0,n.A)({},t),{},{blockNumber:(0,r.uU)(t.blockNumber),gasUsed:(0,r.uU)(t.gasUsed),status:c.Lj[t.status]})))&&void 0!==a?a:[],statusCode:y,status:f,version:m})}},93104(t,e,a){a.d(e,{c:()=>h});var n=a(63536);class o extends n.C{constructor(t){super("Call bundle failed with status: ".concat(t.statusCode),{name:"BundleFailedError"}),Object.defineProperty(this,"result",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.result=t}}var s=a(81385),i=a(56451),r=a(51662),c=a(32574),d=a(62059),u=a(58170),l=a(87192);async function h(t,e){const{id:a,pollingInterval:n=t.pollingInterval,status:h=t=>{let{statusCode:e}=t;return 200===e||e>=300},retryCount:v=4,retryDelay:m=t=>{let{count:e}=t;return 200*(1<<e)},timeout:w=6e4,throwOnFailure:f=!1}=e,y=(0,u.A)(["waitForCallsStatus",t.uid,a]),{promise:g,resolve:C,reject:b}=(0,c.Y)();let P;const T=(0,i.lB)(y,{resolve:C,reject:b},e=>{const i=(0,r.w)(async()=>{const n=t=>{clearTimeout(P),i(),t(),T()};try{const i=await(0,d.b)(async()=>{const e=await(0,s.T)(t,l.k,"getCallsStatus")({id:a});if(f&&"failure"===e.status)throw new o(e);return e},{retryCount:v,delay:m});if(!h(i))return;n(()=>e.resolve(i))}catch(r){n(()=>e.reject(r))}},{interval:n,emitOnBegin:!0});return i});return P=w?setTimeout(()=>{T(),clearTimeout(P),b(new p({id:a}))},w):void 0,await g}class p extends n.C{constructor(t){let{id:e}=t;super('Timed out while waiting for call bundle with id "'.concat(e,'" to be confirmed.'),{name:"WaitForCallsStatusTimeoutError"})}}},96945(t,e,a){a.d(e,{v:()=>b});var n=a(24107),o=a(15882),s=a(34264),i=a(27626),r=a(63536),c=a(97535),d=a(52345),u=a(43877),l=a(52578),h=a(50930),p=a(81385),v=a(38166),m=a(86286),w=a(62091),f=a(21904),y=a(66019);const g=["account","chain","accessList","authorizationList","blobs","data","gas","gasPrice","maxFeePerBlobGas","maxFeePerGas","maxPriorityFeePerGas","nonce","type","value"],C=new v.A(128);async function b(t,e){const{account:a=t.account,chain:v=t.chain,accessList:b,authorizationList:P,blobs:T,data:x,gas:A,gasPrice:F,maxFeePerBlobGas:I,maxFeePerGas:L,maxPriorityFeePerGas:E,nonce:M,type:N,value:R}=e,k=(0,o.A)(e,g);if("undefined"===typeof a)throw new i.T({docsPath:"/docs/actions/wallet/sendTransaction"});const B=a?(0,s.J)(a):null;try{(0,m.c)(e);const a=await(async()=>e.to?e.to:null!==e.to&&P&&P.length>0?await(0,c.g)({authorization:P[0]}).catch(()=>{throw new r.C("`to` is required. Could not infer from `authorizationList`.")}):void 0)();if("json-rpc"===(null===B||void 0===B?void 0:B.type)||null===B){var z;let e;null!==v&&(e=await(0,p.T)(t,w.T,"getChainId")({}),(0,d.v)({currentChainId:e,chain:v}));const o=null===(z=t.chain)||void 0===z||null===(z=z.formatters)||void 0===z||null===(z=z.transactionRequest)||void 0===z?void 0:z.format,s=(o||h.Bv)((0,n.A)((0,n.A)({},(0,l.o)(k,{format:o})),{},{accessList:b,account:B,authorizationList:P,blobs:T,chainId:e,data:x,gas:A,gasPrice:F,maxFeePerBlobGas:I,maxFeePerGas:L,maxPriorityFeePerGas:E,nonce:M,to:a,type:N,value:R}),"sendTransaction"),i=C.get(t.uid),r=i?"wallet_sendTransaction":"eth_sendTransaction";try{return await t.request({method:r,params:[s]},{retryCount:0})}catch(_){if(!1===i)throw _;const e=_;if("InvalidInputRpcError"===e.name||"InvalidParamsRpcError"===e.name||"MethodNotFoundRpcError"===e.name||"MethodNotSupportedRpcError"===e.name)return await t.request({method:"wallet_sendTransaction",params:[s]},{retryCount:0}).then(e=>(C.set(t.uid,!0),e)).catch(a=>{const n=a;if("MethodNotFoundRpcError"===n.name||"MethodNotSupportedRpcError"===n.name)throw C.set(t.uid,!1),e;throw n});throw e}}if("local"===(null===B||void 0===B?void 0:B.type)){var G;const e=await(0,p.T)(t,f.ft,"prepareTransactionRequest")((0,n.A)((0,n.A)({account:B,accessList:b,authorizationList:P,blobs:T,chain:v,data:x,gas:A,gasPrice:F,maxFeePerBlobGas:I,maxFeePerGas:L,maxPriorityFeePerGas:E,nonce:M,nonceManager:B.nonceManager,parameters:[...f.MM,"sidecars"],type:N,value:R},k),{},{to:a})),o=null===v||void 0===v||null===(G=v.serializers)||void 0===G?void 0:G.transaction,s=await B.signTransaction(e,{serializer:o});return await(0,p.T)(t,y.L,"sendRawTransaction")({serializedTransaction:s})}if("smart"===(null===B||void 0===B?void 0:B.type))throw new i.Z({metaMessages:["Consider using the `sendUserOperation` Action instead."],docsPath:"/docs/actions/bundler/sendUserOperation",type:"smart"});throw new i.Z({docsPath:"/docs/actions/wallet/sendTransaction",type:null===B||void 0===B?void 0:B.type})}catch(j){if(j instanceof i.Z)throw j;throw(0,u.p)(j,(0,n.A)((0,n.A)({},e),{},{account:B,chain:e.chain||void 0}))}}}}]);