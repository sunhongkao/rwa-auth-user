"use strict";(self.webpackChunkprivy_atuh=self.webpackChunkprivy_atuh||[]).push([[937],{42052(e,t,a){a.d(t,{u:()=>o});var l=a(97715),r=a(87931),s=a(14766);const o=()=>{let{walletProxy:e,recoverEmbeddedWallet:t,setUser:a,refreshSessionAndUser:o,privy:n,client:c}=(0,s.u)(),d=(0,r.u)();return{create:async r=>{let{walletIndex:s,chainType:i,latestUser:u,recoveryMethod:h,recoveryPassword:w,recoveryAccessToken:y}=r,v=u;v||(v=await o());let m=await c.getAccessToken();if(!v||!m||!e)throw Error("User must be authenticated before creating a Privy wallet");return await(0,l.k)({appConfig:d,user:v,refreshSessionAndUser:o,privy:n,accessToken:m,proxy:e,recoverEmbeddedWallet:t,setUser:a,walletIndex:s,chainType:i,recoveryMethod:h,recoveryPassword:w,recoveryAccessToken:y})}}}},60937(e,t,a){a.r(t),a.d(t,{EmbeddedWalletOnAccountCreateScreen:()=>y,EmbeddedWalletOnAccountCreateView:()=>w,default:()=>y});var l=a(24107),r=a(85089),s=a(2154),o=a(58661),n=a(87931),c=a(97916),d=a(14766),i=a(42052),u=a(52034),h=a(99743);a(72025),a(99130),a(15546),a(15656),a(56348);const w=e=>{let{errorMessage:t,onClose:a}=e;return(0,r.jsx)(h.S,t?{title:"Something went wrong",subtitle:t,icon:s.A,iconVariant:"error",primaryCta:{label:"Close",onClick:a},watermark:!0}:{title:"Creating your wallet",subtitle:"Please wait...",iconVariant:"loading",watermark:!1})},y={component:()=>{let{setModalData:e,navigate:t,data:a,onUserCloseViaDialogOrKeybindRef:s}=(0,u.a)(),h=(0,n.u)(),[y,v]=(0,o.useState)(""),{embeddedWallets:m}=(0,n.u)(),{authenticated:C,user:b}=(0,u.u)(),{closePrivyModal:A,walletProxy:g,client:S}=(0,d.u)(),{onSuccess:p,onFailure:f,callAuthOnSuccessOnClose:k,shouldCreateEth:O,shouldCreateSol:U}=a.createWallet,W="legacy-embedded-wallets-only"===h.embeddedWallets.mode&&!0===(null===h||void 0===h?void 0:h.embeddedWallets.requireUserOwnedRecoveryOnCreate),[x,E]=(0,o.useState)(null),{create:T}=(0,i.u)(),P=null!==O&&void 0!==O?O:!!b&&(0,c.s)(b,h.embeddedWallets.ethereum.createOnLogin),I=null!==U&&void 0!==U?U:!!b&&(0,c.k)(b,h.embeddedWallets.solana.createOnLogin),M=new c.R(async()=>{let e=await S.getAccessToken();if(b&&e&&g)try{let e;if(P&&I)e=await T({chainType:"ethereum",walletIndex:0,latestUser:b}),e=await T({chainType:"solana",walletIndex:0,latestUser:e.user});else if(I)e=await T({chainType:"solana",walletIndex:0,latestUser:b});else{if(!P)return void A({shouldCallAuthOnSuccess:k});e=await T({chainType:"ethereum",walletIndex:0,latestUser:b})}E(e),t("EmbeddedWalletCreatedScreen")}catch(e){v(e.message)}});return(0,o.useEffect)(()=>C&&b?W?(e((0,l.A)((0,l.A)({},a),{},{createWallet:(0,l.A)((0,l.A)({},a.createWallet),{},{shouldCreateEth:P,shouldCreateSol:I}),recoverySelection:(0,l.A)((0,l.A)({},null===a||void 0===a?void 0:a.recoverySelection),{},{isInAccountCreateFlow:!0,shouldCreateEth:P,shouldCreateSol:I})})),t((0,c.E)({walletAction:"create",showAutomaticRecovery:!1,availableRecoveryMethods:m.userOwnedRecoveryOptions,legacySetWalletPasswordFlow:!1,isResettingPassword:!1}))):void M.execute():(t("LandingScreen"),void f(Error("User must be authenticated before creating a Privy wallet"))),[W,C]),s.current=()=>null,(0,r.jsx)(w,{errorMessage:y||void 0,onClose:()=>{x?(p(x),A({shouldCallAuthOnSuccess:k})):(f(new d.m("User wallet creation failed")),A({shouldCallAuthOnSuccess:!1}))}})}}}}]);