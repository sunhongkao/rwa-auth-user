"use strict";(self.webpackChunkprivy_atuh=self.webpackChunkprivy_atuh||[]).push([[8060],{27384(e,r,o){o.d(r,{L:()=>a});var n=o(1754);let t=(0,n.i7)(["from,to{background:var(--privy-color-foreground-4);color:var(--privy-color-foreground-4);}50%{background:var(--privy-color-foreground-accent);color:var(--privy-color-foreground-accent);}"]);const a=(0,n.AH)(["",""],e=>e.$isLoading?(0,n.AH)(["width:35%;animation:"," 2s linear infinite;border-radius:var(--privy-border-radius-sm);"],t):"")},42648(e,r,o){o.d(r,{C:()=>d});var n=o(24107),t=o(15882),a=o(85089),l=o(1754),i=o(27384);const s=["children","color","isLoading","isPulsing"],d=e=>{let{children:r,color:o,isLoading:l,isPulsing:i}=e,d=(0,t.A)(e,s);return(0,a.jsx)(c,(0,n.A)((0,n.A)({$color:o,$isLoading:l,$isPulsing:i},d),{},{children:r}))};let c=l.I4.span.withConfig({displayName:"StyledSpan",componentId:"sc-80725f4-0"})(["padding:0.25rem;font-size:0.75rem;font-weight:500;line-height:1rem;border-radius:var(--privy-border-radius-xs);display:flex;align-items:center;"," ",""],e=>{let r,o;"green"===e.$color&&(r="var(--privy-color-success-dark)",o="var(--privy-color-success-light)"),"red"===e.$color&&(r="var(--privy-color-error)",o="var(--privy-color-error-light)"),"gray"===e.$color&&(r="var(--privy-color-foreground-2)",o="var(--privy-color-background-2)");let n=(0,l.i7)(["from,to{background-color:",";}50%{background-color:rgba(",",0.8);}"],o,o);return(0,l.AH)(["color:",";background-color:",";",";"],r,o,e.$isPulsing&&(0,l.AH)(["animation:"," 3s linear infinite;"],n))},i.L)},86687(e,r,o){o.r(r),o.d(r,{MfaAuthEnrollmentFlowScreen:()=>y,default:()=>y});var n=o(24107),t=o(85089),a=o(85652),l=o(47548),i=o(58661),s=o(39736),d=o(13800),c=o(44271),u=o(87931),h=o(52034),v=o(7755),m=o(52159);o(15546),o(99130),o(72025),o(15656),o(56348),o(6768);const y={component:()=>{var e;let{user:r,ready:o}=(0,h.u)(),{data:y,onUserCloseViaDialogOrKeybindRef:f}=(0,h.a)(),p=(0,u.u)(),[g,x]=(0,i.useState)(null),[j,k]=(0,i.useState)(null),[b,w]=(0,i.useState)(null),[M,A]=(0,i.useState)(!1),[C,S]=(0,i.useState)(!1),[F,P]=(0,i.useState)(),$=async()=>{F?E(F):r?await L({user:r}):E(Error("Must be logged in to manage MFA")),setTimeout(()=>{x(null),k(null)},500)};if(f.current=$,null===y||void 0===y||!y.mfaEnroll)throw Error("Missing modal data for MFA enrollment screen.");let{onFailure:E,onSuccess:L,onBack:R,mfaMethods:T,verify:I,generateTotpSecret:B,enrollTotp:H,unenrollTotp:U,enrollPasskey:N}=y.mfaEnroll,O=null===r||void 0===r?void 0:r.mfaMethods.includes("sms"),W=null===r||void 0===r?void 0:r.mfaMethods.includes("totp"),_=null===r||void 0===r?void 0:r.mfaMethods.includes("passkey"),z=!(null===r||void 0===r||!r.phone),D=null!==(e=null===r||void 0===r?void 0:r.linkedAccounts.filter(e=>"passkey"===e.type).map(e=>e.credentialId))&&void 0!==e?e:[];function K(){x(null),k(null),P(void 0)}async function V(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D;try{P(void 0),S(!0);let r=await N(e);return await L({user:r})}catch(e){P(e)}finally{S(!1),A(!1)}}if(!o||!r||!p)return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.M,{onClose:$,backFn:R},"header"),(0,t.jsx)(m.A,{children:(0,t.jsx)(v.M,{})}),(0,t.jsx)(m.C,{children:(0,t.jsx)(d.L,{})}),(0,t.jsx)(c.a,{})]});if("sms"===g)return null;if("totp"===g)return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.M,{backFn:K,onClose:$},"header"),(0,t.jsx)(m.I,{style:{marginBottom:"1.5rem"},children:(0,t.jsx)(a.A,{})}),(0,t.jsx)(m.T,{children:"Remove authenticator app verification?"}),(0,t.jsxs)(m.S,{children:["MFA adds an extra layer of security to your ",null===p||void 0===p?void 0:p.name," account. Make sure you have other methods to secure your account."]}),(0,t.jsx)(m.B,{children:(0,t.jsx)(s.P,{$warn:!0,onClick:async function(){try{P(void 0),S(!0);let e=await U();return await L({user:e})}catch(e){P(e)}finally{S(!1),x(null)}},loading:C,children:"Remove"})}),(0,t.jsx)(c.a,{})]});if("passkey"===g){var q;let e=null===(q=y.mfaEnroll.shouldUnlinkOnUnenrollMfa)||void 0===q||q;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.M,{backFn:K,onClose:$},"header"),(0,t.jsx)(m.I,{style:{marginBottom:"1.5rem"},children:(0,t.jsx)(a.A,{})}),(0,t.jsx)(m.T,{children:"Are you sure you want to remove this passkey?"}),(0,t.jsx)(m.S,{children:e?"Removing your passkey will remove as both a verification method and a login method.":"Removing your passkey will remove as a verification method."}),(0,t.jsx)(m.B,{children:(0,t.jsx)(s.P,{$warn:!0,onClick:async function(){try{P(void 0),S(!0);let e=await N([]);return await L({user:e})}catch(e){P(e)}finally{S(!1),x(null)}},loading:C,children:"Remove"})}),(0,t.jsx)(c.a,{})]})}return 0!==T.length||O||W||_?"sms"===j?null:"totp"===j&&b?(0,t.jsx)(v.E,{onClose:$,onReset:K,submitEnrollmentWithTotp:e=>async function(e){try{P(void 0),S(!0);let r=await H(e);return await L({user:r})}catch(e){P(e)}finally{S(!1),x(null)}}(e.mfaCode),error:F,totpInfo:(0,n.A)((0,n.A)({},b),{},{appName:(null===p||void 0===p?void 0:p.name)||"Privy"})}):"passkey"===j?(0,t.jsx)(v.a,{onReset:K,onClose:$,submitEnrollmentWithPasskey:V}):(0,t.jsx)(v.b,{showIntro:!0,userMfaMethods:r.mfaMethods,appMfaMethods:p.mfa.methods,userHasAuthSms:z,backFn:R,handleSelectMethod:async function(e){P(void 0);try{await I()}catch(e){return void P(e)}return"totp"===e?(k(e),w(null),void B().then(e=>{let{totpSecret:r,totpAuthUrl:o}=e;w({authUrl:o,secret:r})}).catch(()=>{w(null),K()})):"passkey"===e&&1===D.length?await V():void k(e)},isTotpLoading:"totp"===j&&!b,isPasskeyLoading:M,error:F,onClose:$,setRemovingMfaMethod:async function(e){P(void 0);try{await I()}catch(e){return void P(e)}x(e)}}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.M,{onClose:$,backFn:R},"header"),(0,t.jsx)(m.I,{style:{marginBottom:"1.5rem"},children:(0,t.jsx)(l.A,{})}),(0,t.jsx)(m.T,{children:"Add more security"}),(0,t.jsxs)(m.S,{children:[null===p||void 0===p?void 0:p.name," does not have any verification methods enabled."]}),(0,t.jsx)(m.B,{children:(0,t.jsx)(s.P,{onClick:$,children:"Close"})}),(0,t.jsx)(c.a,{})]})}}}}]);