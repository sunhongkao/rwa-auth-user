"use strict";(self.webpackChunkprivy_atuh=self.webpackChunkprivy_atuh||[]).push([[8025],{18025(e,n,t){t.r(n),t.d(n,{MfaEnrollmentFlowScreen:()=>R,default:()=>R});var o=t(24107),l=t(85089),r=t(85652),i=t(47548),a=t(15882),s=t(58661);const d=["title","titleId"];function c(e,n){let{title:t,titleId:o}=e,l=(0,a.A)(e,d);return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":o},l),t?s.createElement("title",{id:o},t):null,s.createElement("path",{fillRule:"evenodd",d:"M8.603 3.799A4.49 4.49 0 0 1 12 2.25c1.357 0 2.573.6 3.397 1.549a4.49 4.49 0 0 1 3.498 1.307 4.491 4.491 0 0 1 1.307 3.497A4.49 4.49 0 0 1 21.75 12a4.49 4.49 0 0 1-1.549 3.397 4.491 4.491 0 0 1-1.307 3.497 4.491 4.491 0 0 1-3.497 1.307A4.49 4.49 0 0 1 12 21.75a4.49 4.49 0 0 1-3.397-1.549 4.49 4.49 0 0 1-3.498-1.306 4.491 4.491 0 0 1-1.307-3.498A4.49 4.49 0 0 1 2.25 12c0-1.357.6-2.573 1.549-3.397a4.49 4.49 0 0 1 1.307-3.497 4.49 4.49 0 0 1 3.497-1.307Zm7.007 6.387a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z",clipRule:"evenodd"}))}const u=s.forwardRef(c),h=["title","titleId"];function m(e,n){let{title:t,titleId:o}=e,l=(0,a.A)(e,h);return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":o},l),t?s.createElement("title",{id:o},t):null,s.createElement("path",{fillRule:"evenodd",d:"M4.5 3.75a3 3 0 0 0-3 3v10.5a3 3 0 0 0 3 3h15a3 3 0 0 0 3-3V6.75a3 3 0 0 0-3-3h-15Zm4.125 3a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Zm-3.873 8.703a4.126 4.126 0 0 1 7.746 0 .75.75 0 0 1-.351.92 7.47 7.47 0 0 1-3.522.877 7.47 7.47 0 0 1-3.522-.877.75.75 0 0 1-.351-.92ZM15 8.25a.75.75 0 0 0 0 1.5h3.75a.75.75 0 0 0 0-1.5H15ZM14.25 12a.75.75 0 0 1 .75-.75h3.75a.75.75 0 0 1 0 1.5H15a.75.75 0 0 1-.75-.75Zm.75 2.25a.75.75 0 0 0 0 1.5h3.75a.75.75 0 0 0 0-1.5H15Z",clipRule:"evenodd"}))}const v=s.forwardRef(m);var x=t(39736),f=t(13800),j=t(44271),y=t(87931),p=t(14766),w=t(52034),g=t(97916),k=t(7755),C=t(79787),M=t(58979),S=t(37826),b=t(54490),E=t(52159),A=t(32308);t(15546),t(99130),t(72025),t(15656),t(56348),t(6768);const F=e=>{let{appName:n,onComplete:t,onReset:o,onClose:r}=e,[i,a]=(0,s.useState)(""),[d,c]=(0,s.useState)(!1),[u,h]=(0,s.useState)(null),[m,v]=(0,s.useState)("enroll"),{initEnrollmentWithSms:f,submitEnrollmentWithSms:p}=(0,g.d)(),{data:k}=(0,w.a)(),F=(0,y.u)();function R(){var e;null!==k&&void 0!==k&&null!==(e=k.mfaEnrollmentFlow)&&void 0!==e&&e.onSuccess(),t()}return u?(0,l.jsx)(A.ErrorScreenView,{allowlistConfig:F.allowlistConfig,error:u,onBack:()=>h(null),onRetry:()=>h(null)}):(0,l.jsxs)(l.Fragment,"enroll"===m?{children:[(0,l.jsx)(j.M,{backFn:o,onClose:r},"header"),(0,l.jsx)(E.I,{style:{marginBottom:"1.5rem"},children:(0,l.jsx)(M.A,{})}),(0,l.jsx)(E.T,{children:"Set up SMS verification"}),(0,l.jsxs)(E.S,{children:["We'll text a verification code to this mobile device whenever you use your ",n," ","wallet."]}),(0,l.jsxs)(E.C,{children:[(0,l.jsx)(b.C,{onSubmit:async function(e){let{qualifiedPhoneNumber:n}=e;try{await f({phoneNumber:n}),a(n),v("verify")}catch(n){h(n)}},hideRecent:!0}),(0,l.jsxs)(E.a,{children:["By providing your mobile number, you agree to receive text messages from ",null===F||void 0===F?void 0:F.name,". Some carrier charges may apply"]})]}),(0,l.jsx)(j.a,{})]}:d?{children:[(0,l.jsx)(j.M,{onClose:R},"header"),(0,l.jsx)(E.I,{style:{marginBottom:"1.5rem"},children:(0,l.jsx)(C.A,{})}),(0,l.jsx)(E.T,{children:"SMS verification added"}),(0,l.jsxs)(E.S,{children:["From now on, you'll enter the verification code sent to your mobile device whenever you use your ",n," wallet."]}),(0,l.jsx)(E.B,{children:(0,l.jsx)(x.P,{onClick:R,children:"Done"})}),(0,l.jsx)(j.a,{})]}:{children:[(0,l.jsx)(j.M,{backFn:function(){"verify"===m?v("enroll"):o()},onClose:r},"header"),(0,l.jsx)(E.I,{style:{marginBottom:"1.5rem"},children:(0,l.jsx)(M.A,{})}),(0,l.jsx)(E.T,{children:"Enter enrollment code"}),(0,l.jsxs)(E.C,{children:[(0,l.jsx)(E.N,{onChange:async function(e){try{if(!e)return;await p({phoneNumber:i,mfaCode:e}),c(!0)}catch(e){if((0,g.f)(e))throw Error("You have exceeded the maximum number of attempts. Please close this window and try again in 10 seconds.");if((0,g.g)(e))throw Error("The code you entered is not valid");if((0,g.h)(e))throw Error("You have exceeded the time limit for code entry. Please try again in 30 seconds.");throw(0,g.i)(e)?Error("Verification canceled"):Error("Unknown error")}}}),(0,l.jsxs)(E.S,{children:["To continue, enter the 6-digit code sent to ",(0,l.jsx)("strong",{children:(0,S.Ds)(i)})]})]}),(0,l.jsx)(j.a,{})]})},R={component:()=>{var e;let{user:n,enrollInMfa:t,ready:a}=(0,w.u)(),[d,c]=(0,s.useState)(null),{unenrollWithSms:h,unenrollWithTotp:m,unenrollWithPasskey:C,submitEnrollmentWithTotp:M,initEnrollmentWithPasskey:S,submitEnrollmentWithPasskey:b,initEnrollmentWithTotp:A}=(0,g.d)(),{data:R,onUserCloseViaDialogOrKeybindRef:B}=(0,w.a)(),I=(0,y.u)(),{closePrivyModal:P}=(0,p.u)(),{promptMfa:T}=(0,g.u)(),[W,L]=(0,s.useState)(!1),[Z,N]=(0,s.useState)(null),[O,U]=(0,s.useState)(null),H=()=>{P({shouldCallAuthOnSuccess:!0}),t(!1),setTimeout(()=>{c(null),N(null)},500)},[V,D]=(0,s.useState)(!1),[Y,$]=(0,s.useState)();B.current=H;let _=null===n||void 0===n?void 0:n.mfaMethods.includes("sms"),q=!(null===n||void 0===n||!n.phone),K=null===n||void 0===n?void 0:n.mfaMethods.includes("totp"),z=null===n||void 0===n?void 0:n.mfaMethods.includes("passkey"),G=_||K||z,J=null!==(e=null===n||void 0===n?void 0:n.linkedAccounts.filter(e=>"passkey"===e.type).map(e=>e.credentialId))&&void 0!==e?e:[];function Q(){c(null),N(null)}async function X(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J;D(!0);try{var n,t;return await S(),await b({credentialIds:e},{removeForLogin:null===R||void 0===R||null===(n=R.mfaEnrollmentFlow)||void 0===n?void 0:n.shouldUnlinkOnUnenrollMfa}),null!==R&&void 0!==R&&null!==(t=R.mfaEnrollmentFlow)&&void 0!==t&&t.onSuccess(),H()}catch(e){$(e)}finally{D(!1)}}if((0,s.useEffect)(()=>{G&&L(!0)},[G]),!a||!n||!I)return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(j.M,{onClose:H},"header"),(0,l.jsx)(E.A,{children:(0,l.jsx)(k.M,{})}),(0,l.jsx)(E.C,{children:(0,l.jsx)(f.L,{})}),(0,l.jsx)(j.a,{})]});if("sms"===d)return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(j.M,{backFn:Q,onClose:H},"header"),(0,l.jsx)(E.I,{style:{marginBottom:"1.5rem"},children:(0,l.jsx)(r.A,{})}),(0,l.jsx)(E.T,{children:"Remove SMS verification?"}),(0,l.jsxs)(E.S,{children:["MFA adds an extra layer of security to your ",null===I||void 0===I?void 0:I.name," account. Make sure you have other methods to secure your account."]}),(0,l.jsx)(E.B,{children:(0,l.jsx)(x.P,{$warn:!0,onClick:async function(){c(null);try{await h()}catch(e){c(null)}},children:"Remove"})}),(0,l.jsx)(j.a,{})]});if("totp"===d)return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(j.M,{backFn:Q,onClose:H},"header"),(0,l.jsx)(E.I,{style:{marginBottom:"1.5rem"},children:(0,l.jsx)(r.A,{})}),(0,l.jsx)(E.T,{children:"Remove authenticator app verification?"}),(0,l.jsxs)(E.S,{children:["MFA adds an extra layer of security to your ",null===I||void 0===I?void 0:I.name," account. Make sure you have other methods to secure your account."]}),(0,l.jsx)(E.B,{children:(0,l.jsx)(x.P,{$warn:!0,onClick:async function(){c(null);try{await m()}catch(e){c(null)}},children:"Remove"})}),(0,l.jsx)(j.a,{})]});if("passkey"===d){var ee,ne;let e=null===(ee=null===R||void 0===R||null===(ne=R.mfaEnrollmentFlow)||void 0===ne?void 0:ne.shouldUnlinkOnUnenrollMfa)||void 0===ee||ee;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(j.M,{backFn:Q,onClose:H},"header"),(0,l.jsx)(E.I,{style:{marginBottom:"1.5rem"},children:(0,l.jsx)(r.A,{})}),(0,l.jsx)(E.T,{children:"Are you sure you want to remove this passkey?"}),(0,l.jsx)(E.S,{children:e?"Removing your passkey will remove as both a verification method and a login method.":"Removing your passkey will remove as a verification method."}),(0,l.jsx)(E.B,{children:(0,l.jsx)(x.P,{$warn:!0,onClick:async function(){c(null);try{var e;await C({removeForLogin:null===R||void 0===R||null===(e=R.mfaEnrollmentFlow)||void 0===e?void 0:e.shouldUnlinkOnUnenrollMfa})}catch(n){c(null)}},children:"Remove"})}),(0,l.jsx)(j.a,{})]})}if(0===R.mfaEnrollmentFlow.mfaMethods.length&&!G)return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(j.M,{onClose:H},"header"),(0,l.jsx)(E.I,{style:{marginBottom:"1.5rem"},children:(0,l.jsx)(i.A,{})}),(0,l.jsx)(E.T,{children:"Add more security"}),(0,l.jsxs)(E.S,{children:[null===I||void 0===I?void 0:I.name," does not have any verification methods enabled."]}),(0,l.jsx)(E.B,{children:(0,l.jsx)(x.P,{onClick:H,children:"Close"})}),(0,l.jsx)(j.a,{})]});let te=!G&&!W;return te?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(j.M,{onClose:H},"header"),(0,l.jsx)(E.I,{style:{marginBottom:"1.5rem"},children:(0,l.jsx)(i.A,{})}),(0,l.jsx)(E.T,{children:"Transaction Protection"}),(0,l.jsx)(E.S,{children:"Set up transaction protection to add an extra layer of security to your account"}),(0,l.jsxs)(E.L,{children:[(0,l.jsxs)(E.b,{children:[(0,l.jsx)(E.c,{children:(0,l.jsx)(u,{})}),"Enable 2-Step verification for your ",null===I||void 0===I?void 0:I.name," wallet."]}),(0,l.jsxs)(E.b,{children:[(0,l.jsx)(E.c,{children:(0,l.jsx)(v,{})}),"You'll be prompted to authenticate to complete transactions."]})]}),(0,l.jsxs)(E.B,{children:[(0,l.jsx)(x.P,{onClick:()=>L(!0),children:"Continue"}),(0,l.jsx)(x.S,{onClick:H,children:"Not now"})]}),(0,l.jsx)(j.a,{})]}):"sms"===Z?(0,l.jsx)(F,{appName:(null===I||void 0===I?void 0:I.name)||"Privy",onComplete:H,onReset:Q,onClose:H}):"totp"===Z&&O?(0,l.jsx)(k.E,{onClose:H,onReset:Q,submitEnrollmentWithTotp:e=>{let{mfaCode:n}=e;return async function(e){try{var n;return $(void 0),await M({mfaCode:e}),null!==R&&void 0!==R&&null!==(n=R.mfaEnrollmentFlow)&&void 0!==n&&n.onSuccess(),H()}catch(e){$(e)}finally{c(null)}}(n)},totpInfo:(0,o.A)((0,o.A)({},O),{},{appName:(null===I||void 0===I?void 0:I.name)||"Privy"})}):"passkey"===Z?(0,l.jsx)(k.a,{onReset:Q,onClose:H,submitEnrollmentWithPasskey:X}):(0,l.jsx)(k.b,{showIntro:te,userMfaMethods:n.mfaMethods,appMfaMethods:I.mfa.methods,userHasAuthSms:q,backFn:function(){L(!1)},handleSelectMethod:async function(e){try{await T()}catch(e){return void $(e)}return"totp"===e?(N(e),U(null),void A().then(e=>{U(e)}).catch(()=>{U(null),Q()})):"passkey"===e&&1===J.length?await X():void N(e)},isTotpLoading:"totp"===Z&&!O,isPasskeyLoading:V,error:Y,onClose:H,setRemovingMfaMethod:async e=>{try{await T()}catch(e){return void $(e)}c(e)}})}}},79787(e,n,t){t.d(n,{A:()=>a});var o=t(15882),l=t(58661);const r=["title","titleId"];function i(e,n){let{title:t,titleId:i}=e,a=(0,o.A)(e,r);return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":i},a),t?l.createElement("title",{id:i},t):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const a=l.forwardRef(i)}}]);