"use strict";(self.webpackChunkprivy_atuh=self.webpackChunkprivy_atuh||[]).push([[8224],{42052(e,t,a){a.d(t,{u:()=>l});var r=a(97715),s=a(87931),o=a(14766);const l=()=>{let{walletProxy:e,recoverEmbeddedWallet:t,setUser:a,refreshSessionAndUser:l,privy:n,client:c}=(0,o.u)(),i=(0,s.u)();return{create:async s=>{let{walletIndex:o,chainType:u,latestUser:d,recoveryMethod:h,recoveryPassword:w,recoveryAccessToken:y}=s,v=d;v||(v=await l());let p=await c.getAccessToken();if(!v||!p||!e)throw Error("User must be authenticated before creating a Privy wallet");return await(0,r.k)({appConfig:i,user:v,refreshSessionAndUser:l,privy:n,accessToken:p,proxy:e,recoverEmbeddedWallet:t,setUser:a,walletIndex:o,chainType:u,recoveryMethod:h,recoveryPassword:w,recoveryAccessToken:y})}}}},48224(e,t,a){a.r(t),a.d(t,{EmbeddedWalletPasswordCreateScreen:()=>d,default:()=>d});var r=a(85089),s=a(58661),o=a(87931),l=a(97916),n=a(14766),c=a(42052),i=a(52034),u=a(51870);a(72025),a(99130),a(15546),a(15656),a(56348),a(92037),a(33523);const d={component:()=>{let{navigate:e,data:t,onUserCloseViaDialogOrKeybindRef:a}=(0,i.a)(),d=(0,o.u)(),[h,w]=(0,s.useState)(""),[y,v]=(0,s.useState)(!1),[p,f]=(0,s.useState)(),[S,m]=(0,s.useState)(null),{create:b}=(0,c.u)(),{authenticated:g,user:C}=(0,i.u)(),{closePrivyModal:P,isNewUserThisSession:U,initializeWalletProxy:T}=(0,n.u)(),{onSuccess:x,onFailure:A,callAuthOnSuccessOnClose:E,shouldCreateEth:k,shouldCreateSol:I}=t.createWallet,[M,O]=(0,s.useState)(null),W=new l.R(async()=>{try{let t;if(k&&I)t=await b({recoveryMethod:"user-passcode",recoveryPassword:p,chainType:"ethereum",walletIndex:0,latestUser:C}),t=await b({chainType:"solana",walletIndex:0,latestUser:t.user});else if(I)t=await b({recoveryMethod:"user-passcode",recoveryPassword:p,chainType:"solana",walletIndex:0,latestUser:C});else{if(!k)throw Error("Invalid args to create wallet");t=await b({recoveryMethod:"user-passcode",recoveryPassword:p,chainType:"ethereum",walletIndex:0,latestUser:C})}O(t),U?e("EmbeddedWalletCreatedScreen"):(x(t),P({shouldCallAuthOnSuccess:E}))}catch(t){w(t.message)}});return(0,s.useEffect)(()=>{S||T(3e4).then(e=>m(e))},[S]),(0,s.useEffect)(()=>{if(!g||!C)return e("LandingScreen"),void A(Error("User must be authenticated before creating a Privy wallet"))},[g]),a.current=()=>null,(0,r.jsx)(u.S,{config:{initiatedBy:"automatic"},appName:(null===d||void 0===d?void 0:d.name)||"privy",loading:!S,buttonLoading:y,buttonHideAnimations:!M&&y,isResettingPassword:!1,error:h,password:p||"",onClose:()=>{M&&"user-passcode"!==M.account.recoveryMethod?(A(new n.m("User created a wallet but failed to set a password for it")),P({shouldCallAuthOnSuccess:!1})):M?(x(M),P({shouldCallAuthOnSuccess:E})):(A(new n.m("User wallet creation failed")),P({shouldCallAuthOnSuccess:!1}))},onPasswordChange:f,onPasswordGenerate:()=>f((0,u.g)()),onSubmit:async()=>(v(!0),W.execute().then(()=>new Promise(e=>setTimeout(e,250))).finally(()=>v(!1)))})}}}}]);