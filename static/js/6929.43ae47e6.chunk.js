"use strict";(self.webpackChunkprivy_atuh=self.webpackChunkprivy_atuh||[]).push([[6929],{1355(e,n,t){t.d(n,{D:()=>l,M:()=>o});var a=t(85089),s=t(1754);let i=e=>{let{data:n}=e,t=e=>"object"==typeof e&&null!==e?(0,a.jsx)(r,{children:Object.entries(e).map(e=>{let[n,s]=e;return(0,a.jsxs)("li",{children:[(0,a.jsxs)("strong",{children:[n,":"]})," ",t(s)]},n)})}):(0,a.jsx)("span",{children:String(e)});return(0,a.jsx)("div",{children:t(n)})};const o=s.I4.div.withConfig({displayName:"Message",componentId:"sc-70ec2a4f-0"})(["margin-top:1.5rem;background-color:var(--privy-color-background-2);border-radius:var(--privy-border-radius-md);padding:12px;text-align:left;max-height:310px;overflow:scroll;white-space:pre-wrap;width:100%;font-size:0.875rem;font-weight:400;color:var(--privy-color-foreground);line-height:1.5;-ms-overflow-style:none;scrollbar-width:none;&::-webkit-scrollbar{display:none;}"]);let r=s.I4.ul.withConfig({displayName:"MessageList",componentId:"sc-70ec2a4f-1"})(["margin-left:12px !important;white-space:nowrap;&:first-child{margin-left:0 !important;}strong{font-weight:500 !important;}"]);const l=e=>{let{data:n,className:t}=e;return(0,a.jsx)(o,{className:t,children:(0,a.jsx)(i,{data:n})})}},48531(e,n,t){t.d(n,{u:()=>l});var a=t(58661),s=t(92126),i=t(77753),o=t(61703),r=t(14766);function l(e){let{rpcConfig:n,appId:t,address:l,chain:u}=e,{chains:d}=(0,r.u)(),[c,p]=(0,a.useState)(0n),[m,y]=(0,a.useState)(!1),f=(0,a.useMemo)(()=>{let e=u||d[0];if(e)return(0,s.l)({chain:u,transport:(0,i.L)((0,o.a)(e,n,t))})},[u,n,t]),v=(0,a.useCallback)(async()=>{if(!l||!f)return;y(!0);let e=await f.getBalance({address:l}).catch(console.error);return e?(p(e),y(!1),e):void 0},[f,l,p]);return(0,a.useEffect)(()=>{v().catch(console.error)},[]),{balance:c,isLoading:m,reloadBalance:v}}},70425(e,n,t){t.d(n,{E:()=>a});const a=[{constant:!1,inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],name:"transfer",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"}]},74110(e,n,t){t.d(n,{g:()=>o});var a=t(92126),s=t(77753),i=t(61703);const o=async e=>{let{address:n,chain:t,rpcConfig:o,privyAppId:l}=e;try{let e=(0,a.l)({chain:t,transport:(0,s.L)((0,i.a)(t,o,l))}),[u,d]=await Promise.all([e.readContract({abi:r,address:n,functionName:"symbol"}),e.readContract({abi:r,address:n,functionName:"decimals"})]);return{decimals:d,symbol:u}}catch(u){return console.log(u),null}};let r=[{inputs:[],name:"decimals",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"}]},94398(e,n,t){t.d(n,{f:()=>s});let a=2n**256n-1n;const s=e=>{let{amount:n,decimals:t}=e;return n===a?"Maximum":Intl.NumberFormat(void 0,{maximumFractionDigits:t}).format(Number(n)/10**t)}},96929(e,n,t){t.r(n),t.d(n,{SendTransactionScreen:()=>oe,default:()=>oe});var a=t(24107),s=t(85089),i=t(58661),o=t(92126),r=t(77753),l=t(42209),u=t(6266),d=t(63379),c=t(82203),p=t(49088),m=t(74365),y=t(72619),f=t(1598),v=t(87931),b=t(53083),g=t(14766),h=t(52034),T=t(21597),I=t(48531),x=t(74110),k=t(94398),M=t(4661),w=t(13800),S=t(61703),E=t(32308),C=t(1754),_=t(44271),F=t(1355),N=t(28735),A=t(39736),j=t(14145),O=t(62754),R=t(15339),B=t(70425),D=t(97916);t(72025),t(99130),t(15546),t(15656),t(56348);let P=[{constant:!0,inputs:[{name:"_owner",type:"address"}],name:"balanceOf",outputs:[{name:"balance",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"}],q=C.I4.div.withConfig({displayName:"Container",componentId:"sc-31acb2bc-0"})(["display:flex;flex-direction:column;min-height:72px;"]);var L=e=>{let{onBack:n,details:t}=e;return(0,s.jsxs)(q,{children:[(0,s.jsx)(_.M,{backFn:n}),(0,s.jsx)(F.D,{data:t}),(0,s.jsx)(_.B,{})]})};let U=e=>{let{gasUsed:n,effectiveGasPrice:t}=e;if(n&&t)try{return(0,d.nj)(n*t)}catch(n){return}};const V=e=>{let{txn:n,receipt:t,transactionInfo:a,onClose:i,tokenPrice:o,tokenSymbol:r,receiptHeader:l,receiptDescription:u}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(_.M,{onClose:i}),(0,s.jsx)(O.S,{title:null!==l&&void 0!==l?l:"Transaction complete!",description:null!==u&&void 0!==u?u:"You're all set."}),(0,s.jsx)(R.T,{tokenPrice:o,from:t.from,to:t.to,gas:U(t),txn:n,transactionInfo:a,tokenSymbol:r}),(0,s.jsx)(w.Y,{}),(0,s.jsx)(G,{loading:!1,onClick:i,children:"All Done"}),(0,s.jsx)(j.R,{}),(0,s.jsx)(_.B,{})]})};let G=(0,C.I4)(A.P).withConfig({displayName:"SubmitButton",componentId:"sc-f70d0f7a-0"})(["&&{margin-top:24px;}transition:color 350ms ease,background-color 350ms ease;"]);const H=[{constant:!1,inputs:[{name:"_salt",type:"bytes32"},{name:"_initializer",type:"bytes"}],name:"deployAccount",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"}],W=[{name:"from",type:"address"},{name:"param2",type:"address"},{name:"param3",type:"bytes"},{name:"param4",type:"tuple",components:[]},{type:"tuple",components:[{name:"param5",type:"address"},{name:"param6",type:"uint256"},{name:"param7",type:"uint256"},{name:"encodedInitData",type:"bytes"}]}],J=[{constant:!1,inputs:[{name:"spender",type:"address"},{name:"value",type:"uint256"}],name:"approve",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"}],z=[{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"mint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"mint",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"}],name:"mint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"}],name:"mint",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint256",name:"quantity",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"}],name:"mint",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint256",name:"quantity",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"}],name:"mint",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256[]",name:"tokenIds",type:"uint256[]"},{internalType:"uint256[]",name:"quantities",type:"uint256[]"},{internalType:"bytes",name:"data",type:"bytes"}],name:"mintBatch",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256[]",name:"tokenIds",type:"uint256[]"},{internalType:"uint256[]",name:"quantities",type:"uint256[]"},{internalType:"bytes",name:"data",type:"bytes"}],name:"mintBatch",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"quantity",type:"uint256"}],name:"mint",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"quantity",type:"uint256"}],name:"mint",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"}],name:"safeMint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"}],name:"safeMint",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"string",name:"uri",type:"string"}],name:"safeMint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"string",name:"uri",type:"string"}],name:"safeMint",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"safeMint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"safeMint",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"string",name:"uri",type:"string"}],name:"safeMint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"string",name:"uri",type:"string"}],name:"safeMint",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"batchMint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"batchMint",outputs:[],stateMutability:"payable",type:"function"}],K=[{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_tokenId",type:"uint256"}],name:"safeTransferFrom",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"}],Y=[{constant:!1,inputs:[{name:"_operator",type:"address"},{name:"_approved",type:"bool"}],name:"setApprovalForAll",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"}],Z=[{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_tokenId",type:"uint256"}],name:"transferFrom",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"}],Q=[{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_tokenIds",type:"uint256[]"},{name:"_amounts",type:"uint256[]"},{name:"_data",type:"bytes"}],name:"safeBatchTransferFrom",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"}],$=[{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_tokenId",type:"uint256"},{name:"_amount",type:"uint256"},{name:"_data",type:"bytes"}],name:"safeTransferFrom",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"}],X=(e,n)=>{let t=ee(J,e);if(t)return{action:"approve",functionName:"approve",isErc20Ish:!0,isNFTIsh:!1,spender:t.args[0],amount:t.args[1]};let a=ee(B.E,e);if(a)return{action:"transfer",functionName:"transfer",isErc20Ish:!0,isNFTIsh:!1,transferTo:a.args[0],amount:a.args[1]};if(!n)return{action:"transaction",functionName:"",isErc20Ish:!1,isNFTIsh:!1};let s=ee(H,e);if(s&&"string"==typeof s.args[1]){let e=ne(s.args[1]);if(e&&e[4].encodedInitData)return X(e[4].encodedInitData,n)}let i=ee(Y,e);if(i)return{action:"approve",functionName:"setApprovalForAll",isNFTIsh:!0,isErc20Ish:!1,operator:i.args[0],approved:i.args[1]};let o=ee(Z,e);if(o)return{action:"transfer",functionName:"transferFrom",isNFTIsh:!0,isErc20Ish:!1,transferFrom:o.args[0],transferTo:o.args[1],tokenId:o.args[2]};let r=ee(K,e);if(r)return{action:"transfer",functionName:"safeTransferFrom",isNFTIsh:!0,isErc20Ish:!1,transferFrom:r.args[0],transferTo:r.args[1],tokenId:r.args[2]};let l=ee($,e);if(l)return{action:"transfer",functionName:"safeTransferFrom",isNFTIsh:!0,isErc20Ish:!1,transferFrom:l.args[0],transferTo:l.args[1],tokenId:l.args[2],amount:l.args[3]};let u=ee(Q,e);if(u)return{action:"batch transfer",functionName:"safeBatchTransferFrom",isNFTIsh:!0,isErc20Ish:!1,transferFrom:u.args[0],transferTo:u.args[1],tokenIds:u.args[2],amounts:u.args[3]};let d=ee(z,e);return d?{action:"mint",functionName:d.functionName,isNFTIsh:!0,isErc20Ish:!1,args:d.args}:{action:"transaction",isErc20Ish:!1,isNFTIsh:!1}};let ee=(e,n)=>{try{let t=(0,u.J)({abi:e,data:n});return{functionName:t.functionName,args:t.args||[]}}catch(e){return null}},ne=e=>{try{if("string"==typeof e)return(0,l.n)(W,"0x".concat(e.slice(10)))}catch(e){return null}},te=e=>"".concat(parseFloat(e).toFixed(2));function ae(e,n){let t=[],a=new Map;if(e)for(let u of e){var s;if(u.in[0]){let e;e="ERC721"===u.asset.type||"approve_for_all"===u.in[0].value?{id:"nft:".concat(u.asset.name),nftName:u.asset.name,nftCount:u.in.length}:{id:"token:".concat(u.asset.type,":").concat(u.asset.symbol,":").concat(u.asset.name),iconUrl:u.asset.logo_url,value:u.in[0].value,symbol:u.asset.symbol,usdValue:u.in[0].usd_price?te(u.in[0].usd_price):void 0,decimals:u.asset.decimals},t.push(e)}else if(null!==(s=u.out[0])&&void 0!==s&&s.value){let e;e="ERC721"===u.asset.type||"approve_for_all"===u.out[0].value?{id:"nft:".concat(u.asset.name),nftName:u.asset.name}:{id:"token:".concat(u.asset.type,":").concat(u.asset.symbol,":").concat(u.asset.name),iconUrl:u.asset.logo_url,value:u.out[0].value,symbol:u.asset.symbol,usdValue:u.out[0].usd_price?te(u.out[0].usd_price):void 0,decimals:u.asset.decimals},a.has(e.id)||a.set(e.id,e)}}for(let u of n)for(let e of Object.keys(u.spenders)){var i,o,r,l;let n;n="ERC721"===u.asset.type||"approve_for_all"===(null===(i=u.spenders[e])||void 0===i?void 0:i.value)?{id:"nft:".concat(u.asset.name),nftName:u.asset.name}:{id:"token:".concat(u.asset.type,":").concat(u.asset.symbol,":").concat(u.asset.name),iconUrl:u.asset.logo_url,value:null===(o=u.spenders[e])||void 0===o?void 0:o.value,symbol:u.asset.symbol,usdValue:null!==(r=u.spenders[e])&&void 0!==r&&r.usd_price?te(null===(l=u.spenders[e])||void 0===l?void 0:l.usd_price):void 0,decimals:u.asset.decimals},a.has(n.id)||a.set(n.id,n)}return{assetsIn:t,assetsOut:Array.from(a.values())}}let se=new b.P(new b.j("There was an issue preparing your transaction",p.Z9.E32603_DEFAULT_INTERNAL_ERROR.eipCode)),ie=(e,n)=>null!==e&&void 0!==e&&e.sendTransaction?"transactionRequest"in e.sendTransaction?e.sendTransaction.transactionRequest:e.sendTransaction.transactionRequests[n]:void 0;const oe={component:()=>{var e,n,t,l,u,d,C,_,F,A,j,O,R,B,q,U,G,H,W,J;let{data:z,onUserCloseViaDialogOrKeybindRef:K,setModalData:Y,navigate:Z}=(0,h.a)(),{client:Q,rpcConfig:$,chains:ee,closePrivyModal:ne,walletProxy:te,showFiatPrices:oe}=(0,g.u)(),{user:re}=(0,h.u)(),le=(0,v.u)(),[ue,de]=(0,i.useState)(0),[ce,pe]=(0,i.useState)(0),[me,ye]=(0,i.useState)(ie(z,ue)),[fe,ve]=(0,i.useState)(null),[be,ge]=(0,i.useState)(),[he,Te]=(0,i.useState)(!1),[Ie,xe]=(0,i.useState)(null),[ke,Me]=(0,i.useState)(null),[we,Se]=(0,i.useState)(null),[Ee,Ce]=(0,i.useState)(void 0),[_e,Fe]=(0,i.useState)(void 0),[Ne,Ae]=(0,i.useState)(!1),[je,Oe]=(0,i.useState)(!1),[Re,Be]=(0,i.useState)([]),[De,Pe]=(0,i.useState)([]),[qe,Le]=(0,i.useState)("uninitiated"),[Ue,Ve]=(0,i.useState)(void 0);if(!me||null===z||void 0===z||!z.sendTransaction||null===z||void 0===z||!z.sendTransaction)return(0,s.jsx)(E.ErrorScreenView,{error:Error("Invalid transaction request"),allowlistConfig:le.allowlistConfig,onRetry:()=>{var e;null!==z&&void 0!==z&&null!==(e=z.sendTransaction)&&void 0!==e&&e.onFailure(se),ne({shouldCallAuthOnSuccess:!1})}});let{transactingWalletAddress:Ge}=z.sendTransaction,He=(0,i.useMemo)(()=>ee.find(e=>Number(e.id)===Number(me.chainId)),[me.chainId]),We=null!==(e=null===He||void 0===He?void 0:He.nativeCurrency.symbol)&&void 0!==e?e:"ETH",Je=(0,i.useMemo)(()=>X(me.data,!!le.embeddedWallets.extendedCalldataDecoding),[me.data]),{action:ze,isErc20Ish:Ke,isNFTIsh:Ye,functionName:Ze}=Je,{toAddress:Qe,tokenAddress:$e}=(0,i.useMemo)(()=>{var e;return{toAddress:Je.isErc20Ish?Je.transferTo:null!==(e=me.to)&&void 0!==e?e:void 0,tokenAddress:Je.isErc20Ish?me.to:void 0}},[Je]);(0,i.useEffect)(()=>{me.to&&He&&Ke&&(0,x.g)({address:me.to,chain:He,rpcConfig:le.rpcConfig,privyAppId:le.id}).then(ve).catch(console.error)},[me.to,He]);let{tokenPrice:Xe,isTokenPriceLoading:en}=(0,T.u)(me.chainId),{balance:nn}=(0,I.u)({rpcConfig:le.rpcConfig,appId:le.id,address:Ge,chain:He}),tn=function(e){let{rpcConfig:n,appId:t,address:a,chain:s,tokenInfo:l}=e,{chains:u}=(0,g.u)(),[d,c]=(0,i.useState)(null),[p,f]=(0,i.useState)(!1),v=(0,i.useMemo)(()=>{let e=s||u[0];if(e)return(0,o.l)({chain:s,transport:(0,r.L)((0,m.K9)(e,n,t))})},[s,n,t]),b=(0,i.useCallback)(async()=>{if(a&&v&&l.address)try{return f(!0),await v.readContract({address:l.address,abi:P,functionName:"balanceOf",args:[a]})}catch(n){console.error(n)}finally{f(!1)}},[v,a,null===l||void 0===l?void 0:l.address,s]);return(0,i.useEffect)(()=>{b().then(e=>null!=e&&c(e))},[b]),{balance:d,isLoading:p&&null==d,formattedBalance:(0,y.NJ)({amount:null!==d&&void 0!==d?d:BigInt(0),decimals:l.decimals})}}({rpcConfig:le.rpcConfig,appId:le.id,address:Ge,tokenInfo:{address:$e||"",decimals:null!==(n=null===fe||void 0===fe?void 0:fe.decimals)&&void 0!==n?n:18},chain:He}),an=(0,i.useMemo)(()=>(0,S.g)(Number(me.chainId),ee,$,{appId:le.id}),[me.chainId,$]),sn=((e,n,t,a)=>{let[s,o]=(0,i.useState)(null),{walletProxy:r}=(0,g.u)();return(0,i.useEffect)(()=>{s&&o(null),(async()=>{if(!r||!n)return null;let s=[],i=!0,o=await(0,D.p)(e,t,n,a).catch(n=>(n.message&&n.message.includes("Insufficient balance for transaction")||n.message&&n.message.includes("Insufficient funds for gas * price + value")||n.details&&n.details.includes("insufficient funds")?i=!1:s.push(n),e));return{tx:o,totalGasEstimate:o.gas,hasFunds:i,errors:s}})().then(o)},[e]),s})(me,Ge,an,null===z||void 0===z||null===(t=z.sendTransaction)||void 0===t?void 0:t.prepareTransactionRequest);(0,i.useEffect)(()=>{ye(ie(z,ue))},[ue]),(0,i.useEffect)(()=>{var e;null!==(e=z.sendTransaction)&&void 0!==e&&e.getIsSponsored?z.sendTransaction.getIsSponsored().then(ge).catch(console.error):ge(!1)},[z.sendTransaction.getIsSponsored]);let on=()=>{var e,n,t,a;if(!he)return Ie?null===z||void 0===z||null===(e=z.sendTransaction)||void 0===e||e.onSuccess({hash:Ie}):we||null!==sn&&void 0!==sn&&sn.errors[0]?null===z||void 0===z||null===(n=z.sendTransaction)||void 0===n||n.onFailure(null!==(t=null!==we&&void 0!==we?we:null===sn||void 0===sn?void 0:sn.errors[0])&&void 0!==t?t:se):null===z||void 0===z||null===(a=z.sendTransaction)||void 0===a||a.onFailure(new b.P(new b.j("The user rejected the request",p.Z9.E4001_USER_REJECTED_REQUEST.eipCode))),ne({shouldCallAuthOnSuccess:!1})};K.current=on;let rn=!!(z.funding&&z.funding.supportedOptions.length>0),ln=(0,M.g)(BigInt(null!==(l=null===sn||void 0===sn?void 0:sn.totalGasEstimate)&&void 0!==l?l:0n),We),un=oe&&Xe?(0,M.a)(BigInt(null!==(u=null===sn||void 0===sn?void 0:sn.totalGasEstimate)&&void 0!==u?u:0n),Xe):void 0,dn=(0,M.g)(null!==nn&&void 0!==nn?nn:0n,We,void 0,!0),cn=oe&&Xe?(0,M.a)(null!==nn&&void 0!==nn?nn:0n,Xe):void 0,pn=fe&&!tn.isLoading&&Ke&&"approve"!==ze?"".concat(tn.formattedBalance," ").concat(fe.symbol):void 0,mn=null===(d=z.sendTransaction)||void 0===d||null===(d=d.uiOptions)||void 0===d||null===(d=d.transactionInfo)||void 0===d?void 0:d.title;mn||(mn="approve"===ze?Ke?"Confirm address":"Confirm action":"Approve ".concat(ze));let yn=(0,i.useMemo)(()=>{var e,n;if(null!==(e=z.sendTransaction)&&void 0!==e&&null!==(e=e.uiOptions)&&void 0!==e&&e.description)return null===(n=z.sendTransaction)||void 0===n||null===(n=n.uiOptions)||void 0===n?void 0:n.description;if("approve"===ze&&"setApprovalForAll"===Ze&&Je.approved){var t;let e=(0,s.jsx)(f.A,{address:Je.operator||"",url:null===He||void 0===He||null===(t=He.blockExplorers)||void 0===t||null===(t=t.default)||void 0===t?void 0:t.url});return(0,s.jsxs)(s.Fragment,{children:[le.name," would like your permission for ",e," to transfer tokens on your behalf."]})}if("approve"===ze&&"setApprovalForAll"===Ze&&!Je.approved){var a;let e=(0,s.jsx)(f.A,{address:Je.operator||"",url:null===He||void 0===He||null===(a=He.blockExplorers)||void 0===a||null===(a=a.default)||void 0===a?void 0:a.url});return(0,s.jsxs)(s.Fragment,{children:[le.name," would like your permission to revoke permissions of ",e," from transferring tokens on your behalf."]})}return Ke&&"approve"===ze||Ke&&"approve"===ze?"".concat(le.name," would like your permission for ").concat((0,w.D)(Je.spender)," to spend tokens on your behalf."):"".concat(le.name," wants your permission to approve the following transaction.")},[le.name,Ke,Je,null===(C=z.sendTransaction)||void 0===C?void 0:C.uiOptions.description,Ze]),fn=null!==(_=z.sendTransaction)&&void 0!==_&&null!==(_=_.uiOptions)&&void 0!==_&&null!==(_=_.transactionInfo)&&void 0!==_&&null!==(_=_.contractInfo)&&void 0!==_&&_.imgUrl?(0,s.jsx)("img",{src:z.sendTransaction.uiOptions.transactionInfo.contractInfo.imgUrl,alt:z.sendTransaction.uiOptions.transactionInfo.contractInfo.imgAltText}):null,vn=!(!sn||sn.errors[0]||sn.hasFunds||!1!==be),bn=vn&&rn,gn=bn?"Add funds":(null===(F=z.sendTransaction)||void 0===F||null===(F=F.uiOptions)||void 0===F?void 0:F.buttonText)||(ue<ce?"Continue":"Approve");if((0,i.useEffect)(()=>{var e;(null===(e=z.sendTransaction)||void 0===e?void 0:e.scanTransaction)&&le.embeddedWallets.transactionScanning.enabled&&"uninitiated"===qe&&(Le("in progress"),z.sendTransaction.scanTransaction().then(e=>{(e=>{if(!e)throw Error("Transaction scan failed");if("Success"===e.validation.status&&("Benign"===e.validation.result_type?Fe("safe"):"Warning"===e.validation.result_type?Fe("warn"):"Malicious"===e.validation.result_type&&(Fe("error"),Oe(!0))),"Success"!==e.simulation.status)throw Error("Simulation failed");{Ce(e.simulation.params);let{assetsIn:n,assetsOut:t}=ae(e.simulation.assets_diffs,e.simulation.exposures);if(0===t.length&&0===n.length)throw Error("No tokens found");Be(t),Pe(n)}})(e),Le("completed")}).catch(()=>Le("failed")))},[!(null===(A=z.sendTransaction)||void 0===A||!A.scanTransaction)]),(0,i.useEffect)(()=>{var e,n;(null===(e=z.sendTransaction)||void 0===e?void 0:e.scanTransaction)&&"failed"!==qe||((e,n,t)=>{if(pe((e=>null!==e&&void 0!==e&&e.sendTransaction?"transactionRequest"in e.sendTransaction?0:e.sendTransaction.transactionRequests.length-1:0)(z)),n.isErc20Ish&&n.amount&&t){let e=(0,k.f)({amount:n.amount,decimals:t.decimals});Ve(e),Be([{value:e,symbol:null===t||void 0===t?void 0:t.symbol,decimals:null===t||void 0===t?void 0:t.decimals}])}else if(e.value){let n=BigInt(e.value),t=Xe?(0,M.a)(n,Xe):void 0;Be(oe&&t?[{value:t}]:[{value:(0,M.p)(n),symbol:We,decimals:18,usdValue:t}])}else Be(oe?[{value:"$0"}]:[{value:"0",symbol:We,decimals:18}])})(null!==(n=null===sn||void 0===sn?void 0:sn.tx)&&void 0!==n?n:me,Je,fe)},[me,null===sn||void 0===sn?void 0:sn.tx,Je,fe,qe]),ke)return(0,s.jsx)(V,{txn:null!==(j=null===sn||void 0===sn?void 0:sn.tx)&&void 0!==j?j:me,onClose:on,receipt:ke,transactionInfo:null===(O=z.sendTransaction)||void 0===O?void 0:O.uiOptions.transactionInfo,tokenPrice:Xe,tokenSymbol:We,receiptHeader:null===(R=z.sendTransaction)||void 0===R?void 0:R.uiOptions.successHeader,receiptDescription:null===(B=z.sendTransaction)||void 0===B?void 0:B.uiOptions.successDescription});if(we)return(0,s.jsx)(N.T,{transactionError:we,transactionHash:null!==Ie&&void 0!==Ie?Ie:void 0,chainType:"ethereum",chainId:null!==(q=null===sn||void 0===sn?void 0:sn.tx.chainId)&&void 0!==q?q:me.chainId,onClose:on,onRetry:e=>{var n;let{resetNonce:t}=e;Se(null);let s=(0,a.A)({},null!==(n=null===sn||void 0===sn?void 0:sn.tx)&&void 0!==n?n:me);t&&(s.nonce=void 0),ye(s)}});let hn=0!==ce&&"number"==typeof ue&&0!==ue?()=>{de(ue-1)}:void 0;return Ne&&Ee?(0,s.jsx)(L,{details:Ee,onBack:()=>Ae(!1)}):(0,s.jsx)(N.S,{transactionIndex:ue,onBack:hn,maxIndex:ce,disabled:vn&&!rn||je,isSubmitting:he,submitError:we,isPreparing:!sn,isTokenPriceLoading:en,isTokenContractInfoLoading:!Ye&&!fe,prepareError:null===sn||void 0===sn?void 0:sn.errors[0],symbol:null===fe||void 0===fe?void 0:fe.symbol,chain:He,img:fn,title:mn,subtitle:yn,txValue:me.value,fee:null!==un&&void 0!==un?un:ln,isSponsored:be,from:null!==Ge&&void 0!==Ge?Ge:"",to:Qe,tokenAddress:null!==$e&&void 0!==$e?$e:void 0,network:null!==(U=null===(G=le.chains.find(e=>e.id===me.chainId))||void 0===G?void 0:G.name)&&void 0!==U?U:"",transactionDetails:(0,a.A)((0,a.A)({},Je),{},{formattedAmount:Ue}),cta:gn,missingFunds:vn,action:ze,balance:null!==(H=null!==pn&&void 0!==pn?pn:cn)&&void 0!==H?H:dn,onClose:on,onClick:bn?async()=>{var e,n,t;if(!Ge)return;if(!rn)throw Error("Funding wallet is not enabled");let s="FundingMethodSelectionScreen";Y((0,a.A)((0,a.A)({},z),{},{funding:(0,a.A)((0,a.A)({},z.funding),{},{methodScreen:s,chainType:"ethereum",amount:(0,c.c)(BigInt(null!==(e=null===sn||void 0===sn?void 0:sn.tx.value)&&void 0!==e?e:0)+BigInt(null!==(n=null===sn||void 0===sn||null===(t=sn.totalGasEstimate)||void 0===t?void 0:t.toString())&&void 0!==n?n:0)),chain:He}),solanaFundingData:null===z||void 0===z?void 0:z.solanaFundingData})),Z(s)}:async()=>{if(ue<ce)de(ue+1);else{Te(!0);try{var e,n,t;let a=await Q.getAccessToken();if(he||!a||!te||!re)return;let s=await z.sendTransaction.onConfirm({transactionRequest:null!==(e=null===sn||void 0===sn?void 0:sn.tx)&&void 0!==e?e:me});if(xe(s),null!==(n=z.sendTransaction)&&void 0!==n&&n.signOnly)return await new Promise(e=>setTimeout(e,v.q)),null!==z&&void 0!==z&&null!==(t=z.sendTransaction)&&void 0!==t&&t.onSuccess({hash:s}),ne({shouldCallAuthOnSuccess:!1});let i=await an.waitForTransactionReceipt({hash:s});if("reverted"===i.status)throw Error("Transaction failed");Me(i)}catch(s){var a;console.warn({transaction:null!==(a=null===sn||void 0===sn?void 0:sn.tx)&&void 0!==a?a:me,error:s}),Se(s)}finally{Te(!1)}}},validation:_e,hasScanDetails:!!Ee,setIsScanDetailsOpen:Ae,preventMaliciousTransaction:je,setPreventMaliciousTransaction:Oe,tokensSent:Re,tokensReceived:De,isScanning:"in progress"===qe,isCancellable:null!==(W=null===(J=z.sendTransaction)||void 0===J||null===(J=J.uiOptions)||void 0===J?void 0:J.isCancellable)&&void 0!==W&&W,functionName:Ze})}}}}]);